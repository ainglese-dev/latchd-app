[
  {
    "id": "enarsi-vpn-001",
    "question": "What is the primary difference between DMVPN Phase 1 and Phase 2 regarding spoke-to-spoke communication?",
    "options": ["Phase 1 allows direct spoke-to-spoke tunnels; Phase 2 requires hub forwarding", "Phase 1 requires hub forwarding; Phase 2 allows direct spoke-to-spoke tunnels", "Both phases require hub forwarding for spoke-to-spoke traffic", "Both phases allow direct spoke-to-spoke communication"],
    "correct": 1,
    "explanation": "DMVPN Phase 1 requires all spoke-to-spoke traffic to transit through the hub (hub-and-spoke tunnels only). Phase 2 introduces spoke-to-spoke tunnels, allowing direct communication after NHRP resolution. Phase 3 further optimizes this with dynamic spoke-to-spoke tunnels."
  },
  {
    "id": "enarsi-vpn-002",
    "question": "What protocol does DMVPN use to dynamically learn the NBMA (public) IP address of remote spokes?",
    "options": ["ISAKMP", "GRE", "NHRP (Next Hop Resolution Protocol)", "ESP"],
    "correct": 2,
    "explanation": "NHRP (Next Hop Resolution Protocol) is used in DMVPN to map tunnel IP addresses to their corresponding NBMA (public) IP addresses. This allows dynamic tunnel establishment between spokes without static configuration of peer addresses."
  },
  {
    "id": "enarsi-vpn-003",
    "question": "Which DMVPN phase allows spokes to use dynamic (DHCP-assigned) public IP addresses?",
    "options": ["Only Phase 1", "Only Phase 2", "Only Phase 3", "All phases (1, 2, and 3)"],
    "correct": 3,
    "explanation": "All DMVPN phases support spokes with dynamic public IP addresses. The hub's NBMA address must be static or resolvable via DNS, but spokes can register dynamically with the hub using NHRP registration messages."
  },
  {
    "id": "enarsi-vpn-004",
    "question": "What is the purpose of IKE (Internet Key Exchange) Phase 1 in IPsec?",
    "options": ["To encrypt user data", "To establish a secure, authenticated channel (ISAKMP SA) for IKE Phase 2 negotiation", "To perform NAT traversal", "To fragment large packets"],
    "correct": 1,
    "explanation": "IKE Phase 1 establishes a secure, bidirectional ISAKMP SA (Security Association) between peers for IKE protocol messages. This secure channel is then used in Phase 2 to negotiate IPsec SAs for encrypting actual user data."
  },
  {
    "id": "enarsi-vpn-005",
    "question": "Which IPsec protocol provides both encryption and authentication for packet payloads?",
    "options": ["AH (Authentication Header)", "ESP (Encapsulating Security Payload)", "GRE", "NHRP"],
    "correct": 1,
    "explanation": "ESP (Encapsulating Security Payload) provides both confidentiality (encryption) and authentication for packet payloads. AH provides only authentication and integrity but no encryption. ESP is more commonly used in modern VPN deployments."
  },
  {
    "id": "enarsi-vpn-006",
    "question": "What is the main advantage of using GRE over IPsec for tunnel encapsulation?",
    "options": ["GRE provides encryption; IPsec does not", "GRE supports multicast and routing protocols; IPsec tunnel mode does not", "GRE has lower overhead than IPsec", "GRE provides authentication; IPsec does not"],
    "correct": 1,
    "explanation": "GRE (Generic Routing Encapsulation) supports multicast traffic and allows routing protocols (like OSPF, EIGRP) to run across the tunnel, which is not possible with IPsec tunnel mode alone. GRE over IPsec combines GRE's flexibility with IPsec's security."
  },
  {
    "id": "enarsi-vpn-007",
    "question": "What is the primary improvement DMVPN Phase 3 provides over Phase 2?",
    "options": ["Phase 3 adds encryption; Phase 2 does not support it", "Phase 3 enables hierarchical hub topologies and NHRP shortcuts", "Phase 3 uses TCP instead of UDP", "Phase 3 eliminates the need for a hub router"],
    "correct": 1,
    "explanation": "DMVPN Phase 3 introduces NHRP shortcuts and redirect messages, allowing spoke-to-spoke tunnels to be established on demand without requiring the hub to forward the initial packets. It also supports hierarchical hub designs for better scalability."
  },
  {
    "id": "enarsi-vpn-008",
    "question": "What is the purpose of the 'tunnel protection' command in DMVPN configuration?",
    "options": ["To enable GRE keepalives", "To apply IPsec encryption to the GRE tunnel using an IPsec profile", "To configure NHRP authentication", "To enable QoS on the tunnel interface"],
    "correct": 1,
    "explanation": "The 'tunnel protection' command binds an IPsec profile to a tunnel interface, enabling IPsec encryption for the GRE tunnel. This simplifies configuration compared to crypto maps and supports dynamic peers in DMVPN."
  },
  {
    "id": "enarsi-vpn-009",
    "question": "What happens during IKE Phase 2 negotiation?",
    "options": ["Peers authenticate each other and establish ISAKMP SA", "IPsec SAs are negotiated for encrypting user data", "Public IP addresses are exchanged via NHRP", "Dead Peer Detection (DPD) is configured"],
    "correct": 1,
    "explanation": "IKE Phase 2 (Quick Mode) negotiates the IPsec Security Associations (SAs) used to encrypt and authenticate user data. It uses the secure channel established in Phase 1 to exchange keying material and define transform sets for data protection."
  },
  {
    "id": "enarsi-vpn-010",
    "question": "What is the primary benefit of FlexVPN over traditional IPsec VPNs?",
    "options": ["FlexVPN is faster than IPsec", "FlexVPN uses a unified IKEv2-based framework supporting multiple deployment models (site-to-site, remote access)", "FlexVPN does not require certificates", "FlexVPN eliminates the need for encryption"],
    "correct": 1,
    "explanation": "FlexVPN leverages IKEv2 to provide a unified, standards-based VPN solution that supports various deployment models (site-to-site, remote access, hub-and-spoke) with a single configuration framework. It simplifies configuration and improves interoperability compared to legacy IPsec implementations."
  },
  {
    "id": "enarsi-vpn-011",
    "question": "What is the key difference between IPsec transport mode and tunnel mode?",
    "options": ["Transport mode encrypts the entire IP packet and adds a new IP header; tunnel mode encrypts only the payload", "Transport mode encrypts only the payload and preserves the original IP header; tunnel mode encrypts the entire original IP packet and adds a new IP header", "Transport mode is used for site-to-site VPNs; tunnel mode is used for remote access only", "There is no difference; the terms are interchangeable"],
    "correct": 1,
    "explanation": "In transport mode, IPsec encrypts only the packet payload (and transport header) while keeping the original IP header intact — typically used for host-to-host communication. In tunnel mode, the entire original IP packet is encrypted and encapsulated inside a new IP packet with a new header — this is the standard mode for site-to-site VPNs where the original source and destination must be hidden."
  },
  {
    "id": "enarsi-vpn-012",
    "question": "Which of the following is an advantage of IKEv2 over IKEv1?",
    "options": ["IKEv2 uses more exchange messages for stronger security", "IKEv2 supports built-in NAT traversal and requires fewer message exchanges to establish an SA", "IKEv2 eliminates the need for Diffie-Hellman key exchange", "IKEv2 only supports pre-shared key authentication, making it simpler"],
    "correct": 1,
    "explanation": "IKEv2 improves upon IKEv1 in several ways: it requires only 4 messages (2 exchanges) to establish an IKE SA compared to IKEv1's 6 or 9 messages, it has built-in NAT traversal (NAT-T) support, built-in Dead Peer Detection (DPD), and supports EAP authentication. It also supports MOBIKE for mobile clients changing IP addresses."
  },
  {
    "id": "enarsi-vpn-013",
    "question": "What is the purpose of NAT Traversal (NAT-T) in IPsec?",
    "options": ["To translate private IP addresses inside encrypted tunnels", "To encapsulate ESP packets in UDP port 4500 so they can pass through NAT devices", "To dynamically assign public IP addresses to VPN endpoints", "To compress IPsec headers to reduce overhead on NAT devices"],
    "correct": 1,
    "explanation": "NAT devices modify IP headers, which breaks IPsec ESP integrity checks. NAT-T solves this by encapsulating ESP packets inside UDP (port 4500). The NAT device translates the outer UDP/IP header without touching the encrypted ESP payload inside, preserving IPsec integrity. NAT-T is automatically negotiated during IKE when NAT is detected between peers."
  },
  {
    "id": "enarsi-vpn-014",
    "question": "On a Cisco IOS router, what is the advantage of using 'tunnel protection ipsec profile' over legacy crypto maps for securing GRE tunnels?",
    "options": ["Crypto maps support multicast traffic but tunnel protection does not", "Tunnel protection simplifies configuration by binding the IPsec profile directly to the tunnel interface, eliminating the need for ACL-based traffic selection", "Tunnel protection uses a different encryption algorithm than crypto maps", "Crypto maps are no longer supported in any IOS version"],
    "correct": 1,
    "explanation": "With legacy crypto maps, you must define an ACL to match interesting traffic and apply the crypto map to the physical interface. With tunnel protection, you create an IPsec profile and apply it directly to the GRE tunnel interface — all traffic through that tunnel is automatically protected. This approach is simpler, less error-prone, and is the recommended method for protecting GRE tunnels."
  },
  {
    "id": "enarsi-vpn-015",
    "question": "What type of VPN is Cisco GETVPN (Group Encrypted Transport VPN) primarily designed for?",
    "options": ["Remote access VPN for mobile users over the internet", "Point-to-point VPN between two branch offices", "Any-to-any encrypted communication over a private MPLS WAN without tunnel overlays", "SSL-based VPN for clientless browser access"],
    "correct": 2,
    "explanation": "GETVPN is designed for networks with a private WAN infrastructure (such as MPLS). It uses a group key model with a Key Server (KS) that distributes encryption policies and keys to Group Members (GMs). GETVPN preserves the original IP header (tunnel-less), maintaining routing efficiency and enabling any-to-any encrypted communication without building point-to-point tunnels."
  },
  {
    "id": "enarsi-vpn-016",
    "question": "An engineer is troubleshooting a site-to-site IPsec VPN that fails to establish. The 'show crypto isakmp sa' output shows the IKE SA state as 'MM_NO_STATE'. What is the most likely cause?",
    "options": ["The IPsec transform set is mismatched between peers", "The IKE Phase 1 proposal (encryption, hash, authentication, or DH group) is mismatched or the peer is unreachable", "The crypto ACL does not match interesting traffic", "The tunnel interface IP address is incorrect"],
    "correct": 1,
    "explanation": "MM_NO_STATE in Main Mode indicates that IKE Phase 1 negotiation failed at an early stage. The most common cause is a mismatch in the ISAKMP policy parameters (encryption algorithm, hash algorithm, authentication method, or Diffie-Hellman group) between the two peers, or the remote peer is not reachable on UDP port 500. Transform set mismatches would affect Phase 2, not Phase 1."
  },
  {
    "id": "enarsi-vpn-017",
    "question": "An organization's security policy requires that compromise of one VPN session's encryption key must not allow decryption of past or future sessions. Which IPsec feature satisfies this requirement, and how does it work?",
    "options": ["Anti-replay protection, which uses sequence numbers to prevent packet reuse", "Perfect Forward Secrecy (PFS), which performs a new Diffie-Hellman exchange for each Phase 2 SA so session keys are independent", "IKE SA rekey, which changes the Phase 1 key every 24 hours", "Dead Peer Detection (DPD), which tears down sessions to compromised peers"],
    "correct": 1,
    "explanation": "Perfect Forward Secrecy (PFS) ensures that IPsec Phase 2 (Quick Mode) session keys are not derived from the Phase 1 keying material. Instead, a new Diffie-Hellman exchange is performed for each Phase 2 SA. This means that even if one session key is compromised, past and future session keys remain secure because they were generated independently. PFS is configured by specifying a DH group in the IPsec transform set or crypto map."
  }
]
